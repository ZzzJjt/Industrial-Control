PROGRAM RefineryPressureCascadeControl
VAR
    // --- Outer Loop: Pressure Control ---
    Pressure_SP     : REAL := 12.0;     // Pressure Setpoint [bar]
    Pressure_PV     : REAL;             // Measured Pressure [bar]
    Pressure_Error  : REAL;             // Pressure error
    Flow_SP         : REAL;             // Flow setpoint generated by pressure controller

    // --- Inner Loop: Flow Control ---
    Flow_PV         : REAL;             // Measured Flow Rate [L/min]
    Flow_Error      : REAL;             // Flow error
    Flow_Output     : REAL;             // Output to flow control valve/pump

    // --- Controller Gains ---
    Kp_Outer        : REAL := 1.2;      // Pressure loop gain
    Kp_Inner        : REAL := 2.5;      // Flow loop gain
END_VAR

// --- Outer Loop: Pressure Controller ---
Pressure_Error := Pressure_SP - Pressure_PV;
Flow_SP := Kp_Outer * Pressure_Error;

// --- Inner Loop: Flow Controller ---
Flow_Error := Flow_SP - Flow_PV;
Flow_Output := Kp_Inner * Flow_Error;

// Flow_Output drives actuator (e.g., control valve, VFD pump, etc.)
